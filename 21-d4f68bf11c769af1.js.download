"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[21],{76078:function(e,n,t){t.d(n,{Z:function(){return b}});var i=t(26042),o=t(69396),l=t(10253),a=t(85893),s=t(67294),r=t(46440),c=t(72510),d=t(2740),u=t(11355),m=t(69737),f=t(3732),p=t(66261),v=t(66605),h=function(e,n){var t=(0,s.useState)(n),i=t[0],o=t[1];return(0,s.useEffect)((function(){var n,t=function(n){var t=Array.isArray(e)?e:[e],i=!0;t.forEach((function(e){null!==e.current&&e.current.contains(n.target)&&(i=!1)})),i&&o(!1)};i&&(window.addEventListener("click",t),window.top.addEventListener("click",t),null===(n=window.preview)||void 0===n||n.addEventListener("click",t));return function(){var e;window.removeEventListener("click",t),window.top.removeEventListener("click",t),null===(e=window.preview)||void 0===e||e.removeEventListener("click",t)}}),[i,e]),[i,o]};function b(e){var n=e.className,t=e.icon,b=e.iconClassName,x=e.button,g=e.buttonClassName,y=e.openClassName,w=e.iconOpenClassName,j=e.children,k=e.inline,N=e.itemsContainerClass,_=e.mobileContent,C=e.mobileTitle,E=e.tooltip,Z=e.disabled,A=e.placementAlign,T=void 0===A?"end":A,F=e.onOpen,I=e.onButtonClick,L=e.closeOnSelect,S=e.show,V=void 0===S||S,D=e.portal,M=void 0===D||D,O=e.dataTour,R=e.onClose,U=e.showCloseButton,q=void 0===U||U,z=(0,f.ac)("(min-width: 1024px)"),G=(0,s.useState)(null),P=G[0],H=G[1],K=(0,s.useState)(null),B=K[0],W=K[1],Y=(0,s.useRef)(null),X=(0,s.useRef)(null),J=(0,l.Z)(h(Y,!1),2),Q=J[0],$=J[1],ee=(0,r.D)(P,B,{placement:"bottom-".concat(T),modifiers:[{name:"flip",options:{allowedAutoPlacements:["top-start","bottom-start","top-end","bottom-end"]}},{name:"offset",options:{offset:[0,8]}}]}),ne=ee.styles,te=ee.attributes,ie=function(e){e.stopPropagation(),$(!Q);var n=new Event("click",{bubbles:!0});document.dispatchEvent(n),"function"===typeof I&&I(e)},oe=function(){Q&&($(!1),"function"===typeof R&&R())},le=function(){return(0,a.jsx)(c.v.Button,{ref:H,className:(0,f.AK)(g,Q?y:"","z-5"),disabled:Z,onClick:ie,children:x||(0,a.jsx)(p.Z,{icon:t||"DotsVerticalIcon",className:(0,f.AK)(b,"h-5 w-5",Q?w||"text-indigo-500":!b&&"text-gray-500")})})};(0,s.useEffect)((function(){return"function"===typeof F&&F(Q),window.top.addEventListener("dropdown-open",oe),window.top.addEventListener("close-dropdown",oe),function(){window.top.removeEventListener("dropdown-open",oe),window.top.removeEventListener("close-dropdown",oe)}}),[Q]);var ae=M?d.h:s.Fragment;return(0,s.useEffect)((function(){!1===Q&&"function"===typeof R&&R()}),[Q]),(0,a.jsx)(c.v,{"data-tour":O,ref:Y,as:"div",className:(0,f.AK)("relative inline-block text-left",n),onClick:function(e){return e.stopPropagation()},children:function(e){e.open;return(0,a.jsxs)(a.Fragment,{children:[E?(0,a.jsx)(v.Z,{alt:E,disabled:Z,children:le()}):le(),(0,a.jsx)(ae,{children:z?(0,a.jsx)("div",(0,o.Z)((0,i.Z)({className:(0,f.AK)("z-100 transition-opacity",V?"opacity-100":"opacity-0"),ref:X,style:ne.popper},te.popper),{children:(0,a.jsx)(u.u,{show:Q,as:s.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",beforeEnter:function(){return W(X.current)},afterLeave:function(){return W(null)},children:(0,a.jsx)(c.v.Items,{static:!0,className:(0,f.AK)(k?"static":"absolute","origin-top-right z-10 right-0 mt-1 w-full min-w-50 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none overflow-hidden",N),onClick:function(){return L&&$(!1)},children:j})})})):(0,a.jsx)(u.u.Root,{show:Q,as:s.Fragment,children:(0,a.jsx)(m.V,{as:"div",className:"fixed z-100 inset-0 overflow-y-auto",onClose:function(){return $(!1)},children:(0,a.jsxs)("div",{className:"flex items-end justify-center h-full text-center",children:[(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-2xs transition-opacity",onClick:function(){return $(!1)}})}),(0,a.jsx)(u.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4",enterTo:"opacity-100 translate-y-0",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-4",children:(0,a.jsxs)("div",{className:(0,f.AK)("w-full bg-white pt-2 text-left overflow-hidden shadow-xl transform transition-all",_?"flex flex-col h-full":"block rounded-t-lg",!q&&"pb-6"),children:[_&&(0,a.jsx)("div",{className:"flex-1 flex justify-center items-center p-10",children:_}),C&&(0,a.jsxs)("div",{className:"flex md:hidden items-center justify-between gap-3 pl-4 pr-2 pt-1 pb-2 border-b",children:[(0,a.jsx)("p",{className:"font-semibold py-2",children:C}),(0,a.jsx)("button",{className:"light icon transparent",onClick:function(){return $(!1)},children:(0,a.jsx)(p.Z,{icon:"XIcon",className:"w-5 h-5"})})]}),(0,a.jsx)("div",{className:(0,f.AK)("flex flex-col overflow-hidden",N),children:(0,a.jsx)(c.v.Items,{onClick:function(){return L&&$(!1)},children:j})}),q&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("button",{className:"light lg w-full",onClick:function(){return $(!1)},children:"Close"})})]})})]})})})})]})}})}},88575:function(e,n,t){var i=t(85893),o=t(67294),l=t(6235),a=t(3732),s=(0,o.forwardRef)((function(e,n){var t=e.id,s=e.className,r=e.placeholder,c=e.initialValue,d=e.value,u=e.onChange,m=e.onEditorChange,f=e.error,p=e.onDirty,v=e.contentClassName,h=void 0===v?"rich-text-block":v,b=e.toolbar_container,x=e.toolbar,g=e.quickbars_insert_toolbar,y=e.toolbar_groups,w=e.cssFileUrl,j=void 0===w?"/wysiwyg.css":w,k=e.style,N=e.quickbars_selection_toolbar,_=e.quickbars_image_toolbar,C=e.inline,E=void 0!==C&&C,Z=e.autoFocus,A=e.onExecCommand,T=e.onInit,F=e.onLoadContent,I=(0,o.useState)(!1),L=I[0],S=I[1],V=(0,o.useState)(!1),D=V[0],M=V[1],O=(0,o.useState)(!1),R=O[0],U=O[1],q={inline:E,placeholder:r,whitespace_elements:"p pre script noscript style textarea video audio iframe object code",formats:{"p-large":{block:"p",classes:"large"},"p-normal":{block:"p",classes:"normal"},"p-small":{block:"p",classes:"small"},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,block_expand:!0,expand:!1,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]},remove_linebreaks:!1,entity_encoding:"raw",max_height:"100vh",toolbar_mode:"floating",menubar:!1,toolbar_sticky:!1,toolbar_sticky_offset:0,statusbar:!1,branding:!1,body_class:h,style_formats:[{title:"Heading 1",block:"h1"},{title:"Heading 2",block:"h2"},{title:"Heading 3",block:"h3"},{title:"Large Text",format:"p-large"},{title:"Normal Text",format:"p-normal"},{title:"Small Text",format:"p-small"},{title:"Normal Text",block:"p",selector:""}],style_formats_autohide:!0,quickbars_selection_toolbar:null!==N&&void 0!==N?N:"styleselect bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | forecolor backcolor | blockquote",quickbars_insert_toolbar:null!==g&&void 0!==g&&g,quickbars_image_toolbar:null!==_&&void 0!==_&&_,object_resizing:!1,contextmenu:!1,content_css:j,content_style:k,mobile:{toolbar_mode:"floating"},toolbar_groups:null!==y&&void 0!==y?y:{formatting:{icon:"format",tooltip:"Formatting",items:"styleselect bold italic underline strikethrough | superscript subscript"},color:{icon:"color-picker",tooltip:"Color",items:"forecolor backcolor"},align:{icon:"align-left",tooltip:"Aligment",items:"alignleft aligncenter alignright alignjustify"},list:{icon:"unordered-list",tooltip:"Lists",items:"bullist numlist | outdent indent"},add:{icon:"plus",tooltip:"Add",items:"table hr emoticons"}},toolbar:null!==x&&void 0!==x?x:"undo redo | formatting color align list add | fullscreen | removeformat",fixed_toolbar_container:b,table_toolbar:"tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol | tablecellprops tableprops tabledelete",table_appearance_options:!1,table_advtab:!1,external_plugins:{durable:"/plugins/durable/plugin.js"},paste_as_text:!0};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:(0,a.AK)("border rounded-md wysiwyg-editor",s,f?"border-red-500":"border-gray-300",L&&"!z-auto",R&&"ring-2 ring-indigo-500"),children:(0,i.jsx)(l.M,{id:t,tinymceScriptSrc:"https://cdnjs.cloudflare.com/ajax/libs/tinymce/5.10.9/tinymce.min.js",ref:n,initialValue:c,value:d,onFocus:function(){return U(!0)},onBlur:function(e,n){"function"===typeof u&&u(n.getBody().innerHTML),U(!1)},onDirty:p,onMouseEnter:function(){return M(!0)},onEditorChange:function(e){D&&"function"===typeof m&&m(e)},onExecCommand:function(e){"mceFullScreen"===e.command&&S((function(e){return!e})),"function"===typeof A&&A(e)},onBeforeExecCommand:function(e,n){if("mceToggleFormat"===e.command)for(var t=n.formatter.matchAll(["p-large","p-small","p-normal"]),i=0;i<t.length;i++)n.formatter.remove(t[i])},init:q,plugins:["advlist autoresize autolink lists link charmap anchor quickbars visualblocks code fullscreen table paste code hr emoticons preview"],onInit:function(e,n){Z&&n.focus(),"function"===typeof T&&T(e,n)},onLoadContent:function(e,n){"function"===typeof F&&F(e,n)}})}),f?(0,i.jsx)("p",{className:"mt-2 text-sm text-red-600",children:f}):""]})}));s.displayName="WYSIWYG",n.Z=s},27818:function(e,n,t){t.d(n,{Z:function(){return Z}});var i=t(47568),o=t(26042),l=t(69396),a=t(10253),s=t(97582),r=t(85893),c=t(67294),d=t(30120),u=t(25675),m=t.n(u),f=t(41664),p=t.n(f),v=t(11163),h=t(33299),b=t(61437),x=t(51121),g=t(3732),y=t(66261),w=t(52077),j=t(4519),k=t(60728),N=t(12280),_={data:{emailAddress:"",provider:"",connectedAt:"",hasToken:!1,tokenIsValid:!1},ui:{isGmail:!1,emailChanged:!1,emailAddress:"",emailValid:!0}};function C(e){return(null===e||void 0===e?void 0:e.endsWith("@gmail.com"))||(null===e||void 0===e?void 0:e.endsWith("@googlemail.com"))}function E(e,n){var t=n.type,i=n.data,a=n.nylas,s=n.officeEmail;switch(null===t||void 0===t?void 0:t.toUpperCase()){case"SET_EMAIL_INPUT_VALUE":return(0,l.Z)((0,o.Z)({},e),{ui:(0,l.Z)((0,o.Z)({},e.ui),{emailAddress:i.value,emailChanged:e.data.emailAddress===i.value,emailValid:(0,g.oH)(i.value),isGmail:C(i.email)})});case"UPDATE_CONFIG":return(0,l.Z)((0,o.Z)({},e),{data:(0,l.Z)((0,o.Z)({},e.data),{emailAddress:s||"",provider:null===a||void 0===a?void 0:a.provider,connectedAt:null===a||void 0===a?void 0:a.connectedAt,hasToken:!!(null===a||void 0===a?void 0:a.token),tokenIsValid:!(null===a||void 0===a?void 0:a.invalid)}),ui:(0,l.Z)((0,o.Z)({},e.ui),{emailAddress:s,emailChanged:!1,emailValid:(0,g.oH)(s),isGmail:C(s)})});default:throw new Error("Unknown type ".concat(t))}}function Z(e){var n,t,u,f,C,Z,A,T,F,I=e.config,L=void 0===I?{}:I,S=e.loading,V=void 0!==S&&S,D=e.setLoading,M=void 0===D?function(){}:D,O=e.style,R=void 0===O?"inline":O,U=e.modalOpen,q=void 0!==U&&U,z=e.setModalOpen,G=void 0!==z&&z,P=function(e){return se?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)(x.Z,{className:"".concat(e?"mb-4":"w-full min-w-full"),label:"Email",readOnly:K.data.hasToken,error:K.ui.emailValid?"":"You must provide a valid email",name:"email",type:"email",value:K.ui.emailAddress,onChange:function(e){return B({type:"SET_EMAIL_INPUT_VALUE",data:{value:e}})},inputClassName:"w-full min-w-full"}),$&&K.data.provider&&(0,r.jsx)("div",{className:"rounded-md bg-green-50 py-2 px-4 mb-4",children:(0,r.jsxs)("div",{className:"flex md:items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(y.Z,{icon:"CheckIcon",className:"h-5 w-5 text-green-400","aria-hidden":"true"})}),(0,r.jsx)("div",{className:"ml-3 flex-1 md:flex md:justify-between md:items-center",children:K.data.provider&&(0,r.jsxs)("p",{className:"text-sm text-green-700",children:["Email connected via"," ",(0,r.jsx)("span",{className:"font-medium uppercase",children:K.data.provider}),K.data.connectedAt&&" on ".concat(d.ou.fromISO(K.data.connectedAt).toFormat("DD")),"!"]})})]})}),e&&!K.data.tokenIsValid&&(0,r.jsx)("div",{className:"rounded-md bg-yellow-50 py-2 px-4 mb-4",children:(0,r.jsxs)("div",{className:"flex md:items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(y.Z,{icon:"ExclamationIcon",className:"h-5 w-5 text-yellow-400","aria-hidden":"true"})}),(0,r.jsx)("div",{className:"ml-3 flex-1 md:flex md:justify-between md:items-center",children:(0,r.jsxs)("p",{className:"text-sm text-yellow-700",children:[(0,r.jsx)("span",{className:"font-medium mr-2",children:"Sync stopped!"})," You need to reconnect your email."]})})]})})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 ".concat(e?"pb-2":"hidden"),children:[e&&!$&&(0,r.jsx)(w.Z,{onClick:oe,className:"lg light",loading:V,disabled:!K.ui.emailValid,children:K.ui.isGmail?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-5 h-5 relative mr-4 flex-none",children:(0,r.jsx)(m(),{unoptimized:!0,src:(0,g.sd)("google-logo.png"),layout:"fill",alt:"Google"})}),ae," with Google"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.Z,{icon:"InboxInIcon",className:"h-4 w-4 mr-2"})," ",K.data.hasToken?ae:"Connect"]})}),K.data.hasToken&&(0,r.jsxs)(w.Z,{onClick:le,className:"lg light",loading:V,children:[(0,r.jsx)(y.Z,{icon:"TrashIcon",className:"h-4 w-4 mr-2"})," Disconnect"]})]}),(0,r.jsxs)("p",{className:" text-gray-500 body",children:["By connecting your email, you agree to Durable's"," ",(0,r.jsx)(p(),{href:"https://durable.co/privacy-policy",children:(0,r.jsx)("a",{target:"_blank",rel:"noreferrer",className:"link",children:"Privacy Policy"})})," ","and"," ",(0,r.jsx)(p(),{href:"https://durable.co/terms-of-service",children:(0,r.jsx)("a",{target:"_blank",rel:"noreferrer",className:"link",children:"Terms of Service"})}),"."]}),(0,r.jsx)(Q,{confirmText:"Disconnect",attention:!0})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500 body mb-2",children:"Email sync is only available on business plan or higher."}),e&&(0,r.jsx)("a",{className:"button primary",onClick:ie,children:"View plans"})]})},H=(0,c.useReducer)(E,(0,l.Z)((0,o.Z)({},_),{ui:(0,l.Z)((0,o.Z)({},_.ui),{emailAddress:null===L||void 0===L||null===(n=L.office)||void 0===n?void 0:n.email,emailValid:(0,g.oH)(null===L||void 0===L||null===(t=L.office)||void 0===t?void 0:t.email)}),data:{emailAddress:(null===L||void 0===L||null===(u=L.office)||void 0===u?void 0:u.email)||"",provider:null===L||void 0===L||null===(f=L.business)||void 0===f||null===(C=f.nylas)||void 0===C?void 0:C.provider,connectedAt:null===L||void 0===L||null===(Z=L.business)||void 0===Z||null===(A=Z.nylas)||void 0===A?void 0:A.connectedAt}})),K=H[0],B=H[1],W=(0,j.Z)().post,Y=(0,v.useRouter)(),X=(0,k.Z)(),J=X.confirm,Q=X.ConfirmDialog,$=K.data.hasToken&&K.data.tokenIsValid,ee="inline"===R,ne=(0,h.useSession)().data,te=(0,a.Z)((0,b.Z)("layout.paywall"),2)[1],ie=function(){te("default")};(0,c.useEffect)((function(){var e,n;B({type:"UPDATE_CONFIG",nylas:null===L||void 0===L||null===(e=L.business)||void 0===e?void 0:e.nylas,officeEmail:null===L||void 0===L||null===(n=L.office)||void 0===n?void 0:n.email})}),[null===L||void 0===L||null===(T=L.business)||void 0===T?void 0:T.nylas,null===L||void 0===L||null===(F=L.office)||void 0===F?void 0:F.email]);var oe=function(){var e=(0,i.Z)((function(){var e;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return M(!0),[4,W("/nylas/authorize",{email:K.ui.emailAddress,fromCRM:!0}).catch(console.error)];case 1:return(e=n.sent())&&!0===e.status&&e.content?[4,Y.push(e.content.redirectURL)]:[3,3];case 2:return n.sent(),[3,4];case 3:alert.error(e.message),M(!1),n.label=4;case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),le=function(){var e=(0,i.Z)((function(){return(0,s.__generator)(this,(function(e){return J("Disconnect email",(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"mb-4",children:"Are you sure you want to unsync your emails?"}),(0,r.jsxs)("div",{className:"alert danger",children:[(0,r.jsx)(y.Z,{icon:"ExclamationIcon"}),(0,r.jsx)("div",{children:"This will disconnect your email and DELETE all your synced messages from Durable."})]})]}),(0,i.Z)((function(){var e;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return M(!0),[4,W("/nylas/disconnect",{}).catch(console.log)];case 1:return(e=n.sent())&&!0===e.status?Y.reload():(alert.error(e.message),M(!1)),[2]}}))})),null),[2]}))}));return function(){return e.apply(this,arguments)}}(),ae=K.data.tokenIsValid?"Continue":"Reconnect",se=(0,c.useMemo)((function(){var e,n,t;return(null===ne||void 0===ne||null===(e=ne.user)||void 0===e||null===(n=e.plan)||void 0===n||null===(t=n.features)||void 0===t?void 0:t.includes("sync_email"))||!1}),[ne.user]);return ee?P(ee):(0,r.jsxs)(N.u,{title:"Email Sync",open:q,contentClassName:"max-w-110 pb-2 lg:pb-2",buttons:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z,{className:"light",onClick:function(){return G(!1)},children:"Cancel"}),"\xa0",se?(0,r.jsx)(w.Z,{className:"primary",onClick:oe,loading:V,disabled:!K.ui.emailValid,loadingText:"Saving",children:"Connect"}):(0,r.jsx)("a",{className:"button primary",onClick:ie,children:"View plans"})]}),setOpen:G,footerHasMarginTop:!1,children:[(0,r.jsx)("p",{children:"Connect your email to sync your messages with your CRM"}),P(ee)]})}}}]);