"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6219],{76078:function(e,t,n){n.d(t,{Z:function(){return v}});var o=n(26042),i=n(69396),s=n(10253),r=n(85893),a=n(67294),l=n(46440),c=n(72510),u=n(2740),d=n(11355),m=n(69737),p=n(3732),f=n(66261),h=n(66605),x=function(e,t){var n=(0,a.useState)(t),o=n[0],i=n[1];return(0,a.useEffect)((function(){var t,n=function(t){var n=Array.isArray(e)?e:[e],o=!0;n.forEach((function(e){null!==e.current&&e.current.contains(t.target)&&(o=!1)})),o&&i(!1)};o&&(window.addEventListener("click",n),window.top.addEventListener("click",n),null===(t=window.preview)||void 0===t||t.addEventListener("click",n));return function(){var e;window.removeEventListener("click",n),window.top.removeEventListener("click",n),null===(e=window.preview)||void 0===e||e.removeEventListener("click",n)}}),[o,e]),[o,i]};function v(e){var t=e.className,n=e.icon,v=e.iconClassName,g=e.button,b=e.buttonClassName,j=e.openClassName,y=e.iconOpenClassName,w=e.children,N=e.inline,k=e.itemsContainerClass,C=e.mobileContent,Z=e.mobileTitle,A=e.tooltip,S=e.disabled,E=e.placementAlign,F=void 0===E?"end":E,_=e.onOpen,T=e.onButtonClick,I=e.closeOnSelect,K=e.show,D=void 0===K||K,L=e.portal,B=void 0===L||L,O=e.dataTour,z=e.onClose,R=e.showCloseButton,q=void 0===R||R,P=(0,p.ac)("(min-width: 1024px)"),X=(0,a.useState)(null),G=X[0],U=X[1],W=(0,a.useState)(null),M=W[0],V=W[1],$=(0,a.useRef)(null),H=(0,a.useRef)(null),J=(0,s.Z)(x($,!1),2),Q=J[0],Y=J[1],ee=(0,l.D)(G,M,{placement:"bottom-".concat(F),modifiers:[{name:"flip",options:{allowedAutoPlacements:["top-start","bottom-start","top-end","bottom-end"]}},{name:"offset",options:{offset:[0,8]}}]}),te=ee.styles,ne=ee.attributes,oe=function(e){e.stopPropagation(),Y(!Q);var t=new Event("click",{bubbles:!0});document.dispatchEvent(t),"function"===typeof T&&T(e)},ie=function(){Q&&(Y(!1),"function"===typeof z&&z())},se=function(){return(0,r.jsx)(c.v.Button,{ref:U,className:(0,p.AK)(b,Q?j:"","z-5"),disabled:S,onClick:oe,children:g||(0,r.jsx)(f.Z,{icon:n||"DotsVerticalIcon",className:(0,p.AK)(v,"h-5 w-5",Q?y||"text-indigo-500":!v&&"text-gray-500")})})};(0,a.useEffect)((function(){return"function"===typeof _&&_(Q),window.top.addEventListener("dropdown-open",ie),window.top.addEventListener("close-dropdown",ie),function(){window.top.removeEventListener("dropdown-open",ie),window.top.removeEventListener("close-dropdown",ie)}}),[Q]);var re=B?u.h:a.Fragment;return(0,a.useEffect)((function(){!1===Q&&"function"===typeof z&&z()}),[Q]),(0,r.jsx)(c.v,{"data-tour":O,ref:$,as:"div",className:(0,p.AK)("relative inline-block text-left",t),onClick:function(e){return e.stopPropagation()},children:function(e){e.open;return(0,r.jsxs)(r.Fragment,{children:[A?(0,r.jsx)(h.Z,{alt:A,disabled:S,children:se()}):se(),(0,r.jsx)(re,{children:P?(0,r.jsx)("div",(0,i.Z)((0,o.Z)({className:(0,p.AK)("z-100 transition-opacity",D?"opacity-100":"opacity-0"),ref:H,style:te.popper},ne.popper),{children:(0,r.jsx)(d.u,{show:Q,as:a.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",beforeEnter:function(){return V(H.current)},afterLeave:function(){return V(null)},children:(0,r.jsx)(c.v.Items,{static:!0,className:(0,p.AK)(N?"static":"absolute","origin-top-right z-10 right-0 mt-1 w-full min-w-50 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none overflow-hidden",k),onClick:function(){return I&&Y(!1)},children:w})})})):(0,r.jsx)(d.u.Root,{show:Q,as:a.Fragment,children:(0,r.jsx)(m.V,{as:"div",className:"fixed z-100 inset-0 overflow-y-auto",onClose:function(){return Y(!1)},children:(0,r.jsxs)("div",{className:"flex items-end justify-center h-full text-center",children:[(0,r.jsx)(d.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-2xs transition-opacity",onClick:function(){return Y(!1)}})}),(0,r.jsx)(d.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4",enterTo:"opacity-100 translate-y-0",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-4",children:(0,r.jsxs)("div",{className:(0,p.AK)("w-full bg-white pt-2 text-left overflow-hidden shadow-xl transform transition-all",C?"flex flex-col h-full":"block rounded-t-lg",!q&&"pb-6"),children:[C&&(0,r.jsx)("div",{className:"flex-1 flex justify-center items-center p-10",children:C}),Z&&(0,r.jsxs)("div",{className:"flex md:hidden items-center justify-between gap-3 pl-4 pr-2 pt-1 pb-2 border-b",children:[(0,r.jsx)("p",{className:"font-semibold py-2",children:Z}),(0,r.jsx)("button",{className:"light icon transparent",onClick:function(){return Y(!1)},children:(0,r.jsx)(f.Z,{icon:"XIcon",className:"w-5 h-5"})})]}),(0,r.jsx)("div",{className:(0,p.AK)("flex flex-col overflow-hidden",k),children:(0,r.jsx)(c.v.Items,{onClick:function(){return I&&Y(!1)},children:w})}),q&&(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)("button",{className:"light lg w-full",onClick:function(){return Y(!1)},children:"Close"})})]})})]})})})})]})}})}},48176:function(e,t,n){var o=n(85893),i=n(25675),s=n.n(i);t.Z=function(e){var t=e.imgSrc,n=e.title,i=e.subtitle,r=e.cta;return(0,o.jsxs)("div",{className:"flex flex-col gap-5 items-center max-w-100",children:[t&&(0,o.jsx)("div",{className:"relative w-72 h-24 max-w-full",children:(0,o.jsx)(s(),{src:t,alt:n,layout:"fill",objectFit:"cover"})}),(0,o.jsxs)("div",{className:"flex flex-col gap-2 text-center",children:[(0,o.jsx)("p",{className:"body-lg font-bold text-black",children:n}),(0,o.jsx)("p",{className:"text-gray-500",children:i})]}),r]})}},86219:function(e,t,n){n.d(t,{Z:function(){return $}});var o=n(47568),i=n(26042),s=n(69396),r=n(10253),a=n(29815),l=n(97582),c=n(85893),u=n(67294),d=n(61437),m=n(66261),p=n(11163),f=n(33299),h=n(3732),x=n(41125),v=function(e){var t=e.children,n=e.bgColor,o=e.className,s=e.style,r=e.onClick;return(0,c.jsx)("div",{className:(0,h.AK)("flex flex-col w-full rounded-lg relative h-90 overflow-hidden cursor-pointer shadow",o),style:(0,i.Z)({backgroundColor:n},s||{}),onClick:r,children:t})},g=function(e){var t=e.children,n=e.accentColor;return(0,c.jsx)("div",{className:"relative z-5 w-full h-full",style:{background:n},children:t})},b=function(e){var t=e.title,n=e.subtitle,o=e.bgColor,i=e.ActionButton,s=e.allowWrap;return(0,c.jsxs)("div",{className:"absolute z-10 w-full bottom-0 rounded-b-lg overflow-hidden",children:[(0,c.jsx)("div",{className:"relative w-full h-10 -bottom-0.5",style:{background:"linear-gradient(180deg, transparent 0%, ".concat(o," 100%)")}}),(0,c.jsxs)("div",{className:(0,h.AK)("flex flex-1 items-center justify-between p-6 gap-4 rounded-b-lg overflow-hidden",s?"flex-wrap":""),style:{background:o},children:[(0,c.jsxs)("div",{className:"flex flex-col gap-2",style:{color:(0,h.$O)(o)},children:[t&&(0,c.jsx)("p",{className:"text-h4 font-bold",children:t}),n&&(0,c.jsx)("p",{className:"text-sm text-gray-500",children:n})]}),i]})]})},j=function(e){var t=e.className;return(0,c.jsxs)("div",{className:(0,h.AK)("flex flex-col w-full rounded-lg relative h-90 overflow-hidden",t),children:[(0,c.jsx)("div",{className:"relative z-5 w-full h-full bg-gray-200 animate-pulse"}),(0,c.jsxs)("div",{className:"absolute z-10 w-full bottom-0",children:[(0,c.jsx)("div",{className:"relative w-full h-10 bg-gray-200 animate-pulse"}),(0,c.jsx)("div",{className:"flex flex-1 items-center justify-between p-6 gap-4 bg-gray-200 animate-pulse",children:(0,c.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,c.jsx)("p",{className:"text-h4 font-bold bg-gray-200 animate-pulse"}),(0,c.jsx)("p",{className:"text-sm bg-gray-200 animate-pulse"})]})})]})]})},y=function(e){var t=e.title,n=e.subtitle,o=e.ActionButton,i=e.className,s=e.bgColor,r=void 0===s?x.theme.extend.colors.gray[100]:s,a=e.accentColor,l=e.allowFooterWrap,u=e.style,d=e.onClick,m=e.children;return(0,c.jsxs)(v,{className:i,bgColor:r,style:u,onClick:d,children:[(0,c.jsx)(g,{accentColor:a,children:m}),(0,c.jsx)(b,{title:t,subtitle:n,bgColor:r,ActionButton:o,allowWrap:l})]})},w=(n(65135),n(30120)),N=n(25675),k=n.n(N),C=n(72510),Z=n(76078),A=n(70663),S=function(e){var t=e.promotions,n=e.author,o=e.domain,i=e.onDuplicate,s=e.onDelete,r=e.isLoading,a=(0,p.useRouter)(),l={"google-ad":"Google ad","twitter-post":"X/Twitter post","facebook-post":"Facebook post","instagram-post":"Instagram post",email:"Email"},u={"google-ad":"google","twitter-post":"x","facebook-post":"facebook","instagram-post":"instagram",email:"email"};return(0,c.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 3xl:grid-cols-4 4xl:grid-cols-5 gap-4 w-full mb-6",children:r?Array.from({length:3}).map((function(e,t){return(0,c.jsx)(j,{},t)})):t.map((function(e){return(0,c.jsx)(y,{title:l[e.type],subtitle:w.ou.fromISO(e.createdAt).toFormat("DD"),onClick:function(){return a.push("/marketing/promotions/".concat(e._id))},ActionButton:(0,c.jsx)("div",{className:"w-10 h-10 relative flex-none",children:(0,c.jsx)(k(),{unoptimized:!0,src:(0,h.sd)("promotion/".concat(u[e.type],".svg")),layout:"fill",alt:l[e.type]})}),accentColor:x.theme.extend.colors.gray[100],bgColor:"white",children:(0,c.jsxs)("div",{className:"relative flex justify-center p-8 max-h-full overflow-hidden",children:[(0,c.jsx)(A.M,{promotion:e,author:n,domain:o,zoom:.5}),(0,c.jsxs)(Z.Z,{inline:!0,className:"!absolute right-4 top-4",buttonClassName:"border-1 border-gray-300 bg-white p-2.5 text-gray-700 rounded-full",placementAlign:"start",button:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(m.Z,{icon:"DotsVerticalIcon",className:"w-5 h-5","aria-hidden":"true"})}),children:[(0,c.jsx)(C.v.Item,{as:"div",children:(0,c.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2.5 hover:bg-gray-100 text-gray-700 cursor-pointer",onClick:function(t){t.stopPropagation(),i(e,l[e.type])},children:[(0,c.jsx)(m.Z,{icon:"DuplicateIcon",className:"w-4 h-4 text-gray-700","aria-hidden":"true"}),(0,c.jsx)("span",{className:"text-sm font-medium",children:"Duplicate"})]})}),(0,c.jsx)(C.v.Item,{as:"div",children:(0,c.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2.5 hover:bg-red-100 text-red-700 cursor-pointer",onClick:function(t){t.stopPropagation(),s(e,l[e.type])},children:[(0,c.jsx)(m.Z,{icon:"TrashIcon",className:"w-4 h-4 text-red-700","aria-hidden":"true"}),(0,c.jsx)("span",{className:"text-sm font-medium",children:"Delete"})]})})]})]})},e._id)}))})},E=n(12280),F=n(11215),_=n(22959),T=n(51121),I=function(e){var t=e.type,n=e.isLoading,o=e.topic,i=e.setTopic,s=e.placeholder,r=e.onGenerate;return(0,c.jsxs)("div",{className:"flex flex-col gap-4 w-140 max-w-full",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsxs)("p",{className:"font-semibold",children:["What is this ",t," about?"]}),(0,c.jsx)(_.Z,{onClick:r,loading:n,regenerate:!!o})]}),(0,c.jsx)(T.Z,{type:"textarea",placeholder:s,value:o,onChange:i,rows:6,disabled:n})]})},K=n(72521),D=n(33056),L=function(e){var t=e.open,n=e.setOpen,i=e.onSelect,s=e.type,r=e.placeholder,a=(0,u.useState)(""),d=a[0],m=a[1],p=(0,u.useState)(!1),f=p[0],x=p[1],v=(0,F.Z)().current,g=(0,D.Z)().promptSuggestion,b=(0,K.x)(v),j=function(){var e=(0,o.Z)((function(){var e;return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return x(!0),[4,g({label:"suggest-social-media-post-title"})];case 1:return(e=t.sent())&&!0===e.status&&e.content?m(e.content.trim()):h.Z9.error(e.message),x(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,u.useEffect)((function(){b&&j()}),[b]),(0,c.jsx)(E.u,{open:t,setOpen:n,title:"About the ".concat(s),buttons:(0,c.jsx)("button",{className:"primary",disabled:!d,onClick:function(){return function(e){i(e),n(!1)}(d)},children:"Next"}),children:(0,c.jsx)(I,{type:s,topic:d,setTopic:m,placeholder:r,onGenerate:j,isLoading:f})})},B=n(52077),O=n(16494),z=function(e){var t=e.postType,n=e.onChoose,i=(0,u.useState)(""),s=i[0],a=i[1],p=(0,r.Z)((0,d.Z)("post.suggestions.".concat(t),[]),2),f=p[0],x=p[1],v=(0,r.Z)((0,d.Z)("post.suggestions.".concat(t,".loading"),!1),2),g=v[0],b=v[1],j=(0,F.Z)().current,y=(0,D.Z)().promptSuggestion,w=null===j||void 0===j?void 0:j.name,N=(0,K.x)(j);function k(){return C.apply(this,arguments)}function C(){return(C=(0,o.Z)((function(){var e,n;return(0,l.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,3,4]),b(!0),[4,y({label:"generate-social-media-post-topics"},{quantity:10,type:t})];case 1:return(null===(e=o.sent().content)||void 0===e?void 0:e.length)>0&&x(e),[3,4];case 2:return n=o.sent(),console.error(n),[3,4];case 3:return b(!1),[7];case 4:return[2]}}))}))).apply(this,arguments)}(0,u.useEffect)((function(){0===(null===f||void 0===f?void 0:f.length)&&!g&&w&&N&&k()}),[w,N]);var Z=function(e){var t=e.text,n=e.loading,o=e.onClick;return(0,c.jsx)(B.Z,{onClick:o,className:(0,h.AK)("group transition-all flex border-1 border-gray-300 py-3.5 px-4 rounded-3xl text-left disabled:border-gray-300 hover:border-indigo-700 focus:ring-2 focus:ring-indigo-300 focus:ring-inset"),style:{width:"fit-content"},disabled:n,children:(0,c.jsxs)("div",{className:"flex items-center gap-2 text-indigo-600 group-hover:text-indigo-700 text-xs",children:[t,n?(0,c.jsx)(O.Z,{variant:"skeleton",classNameChild:"!w-32 !h-4"}):(0,c.jsx)(m.Z,{icon:"ArrowRightIcon",className:"w-4 h-4"})]})})},A=function(){return(0,c.jsxs)("div",{className:(0,h.AK)("flex flex-wrap gap-2 transition-all overflow-hidden opacity-100"),children:[null===f||void 0===f?void 0:f.map((function(e){return(0,c.jsx)(Z,{text:e,onClick:function(){return n(e)}},e)})),0===(null===f||void 0===f?void 0:f.length)&&(0,c.jsx)("p",{className:"text-gray-500 text-sm",children:"No suggestions available, try again"})]})},S=function(){return(0,c.jsx)("div",{className:(0,h.AK)("flex flex-wrap gap-2 transition-all overflow-hidden opacity-100"),children:Array.from({length:10}).map((function(e,t){return(0,c.jsx)(Z,{loading:!0},t)}))})};return(0,c.jsxs)("div",{className:"flex flex-col gap-4 w-140 max-w-full",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("p",{className:"text-h6 font-semibold",children:"Select a topic"}),(0,c.jsx)(_.Z,{regenerate:(null===f||void 0===f?void 0:f.length)>0,onClick:k,loading:g})]}),g?(0,c.jsx)(S,{}):(0,c.jsx)(A,{}),(0,c.jsxs)("div",{className:"flex gap-2 justify-between",children:[(0,c.jsx)(T.Z,{placeholder:"Or write your own topic",value:s,onChange:function(e){return a(e)},className:"w-full",onKeyUp:function(e){return"Enter"===e.key&&n(s)}}),(0,c.jsx)("button",{className:"light",disabled:!s,onClick:function(){return n(s)},children:(0,c.jsx)(m.Z,{icon:"ArrowRightIcon",className:"h-3 w-3"})})]})]})},R=[{id:"facebook-post",name:"Facebook post",description:"Use Facebook posts to expand reach and connect with your audience.",icon:"facebook"},{id:"instagram-post",name:"Instagram post",description:"Use Instagram posts to boosts  engagement and strengthen brand identity.",icon:"instagram"},{id:"twitter-post",name:"X/Twitter post",description:"Use X posts for brand visibility, and encouraging real-time conversations.",icon:"x"}],q=function(e){var t=e.onSelect;return(0,c.jsx)("div",{className:"flex flex-col gap-4 md:max-w-90 w-full",children:R.map((function(e){return(0,c.jsxs)("div",{className:"group relative flex h-32 gap-4 border border-gray-300 p-4 rounded-md hover:bg-indigo-50 hover:border-indigo-600 cursor-pointer",onClick:function(){t(e)},children:[(0,c.jsxs)("div",{className:"flex-1",children:[(0,c.jsx)("div",{className:"flex items-center gap-2 mb-1",children:(0,c.jsx)("p",{className:"text-sm font-semibold group-hover:text-indigo-700",children:e.name})}),(0,c.jsx)("p",{className:"text-sm mb-2 text-gray-500",children:e.description})]}),(0,c.jsx)("div",{className:"flex-shrink-0 self-center relative w-14 h-14",children:(0,c.jsx)(k(),{unoptimized:!0,className:"rounded",src:(0,h.sd)("promotion/".concat(e.icon,".svg")),layout:"fill",objectFit:"cover",alt:e.name})})]},e.id)}))})},P=function(e){var t=e.open,n=e.setOpen,o=e.onSelect,i=e.initialType,s=function(e){l(e.id),p("".concat(e.name," topic"))},r=(0,u.useState)(null),a=r[0],l=r[1],d=(0,u.useState)("Create post"),m=d[0],p=d[1];return(0,u.useEffect)((function(){if(i){var e=R.find((function(e){return e.id===i}));e&&s(e)}}),[i]),(0,c.jsx)(E.u,{open:t,setOpen:n,title:m,children:a?(0,c.jsx)(z,{postType:a,onChoose:function(e){o(a,e),n(!1)}}):(0,c.jsx)(q,{onSelect:s})})},X=n(80360),G=n(48176),U=n(53371),W=n(60728),M=n(4519),V={post:{img:"empty-posts.svg",title:"No social posts yet",subtitle:"Build community and enhance brand awareness with Facebook, Instagram and X posts"},ad:{img:"empty-ads.svg",title:"No ads yet",subtitle:"Drive targeted traffic, increase conversions with Google ads"},email:{img:"empty-emails.svg",title:"No emails yet",subtitle:"Communicate with clients and nurture relationships"}};function $(e){var t,n,x,v,g,b,j=e.types,y=(0,F.Z)().current,w=(0,r.Z)((0,d.Z)("layout.title","Marketing",!0),2),N=(w[0],w[1],(0,u.useState)((0,h.tl)("website"))),k=N[0],C=N[1],Z=(0,u.useState)(!1),A=Z[0],E=Z[1],_=(0,u.useState)(1),T=_[0],I=_[1],D=(0,u.useState)(""),O=D[0],z=D[1],R=(0,u.useState)(!1),q=R[0],$=R[1],H=(0,u.useState)(!1),J=H[0],Q=H[1],Y=(0,u.useState)(-1),ee=Y[0],te=Y[1],ne=(0,u.useState)(!1),oe=ne[0],ie=ne[1],se=(0,u.useState)(j[0].id),re=se[0],ae=se[1],le=(0,u.useState)((0,h.tl)("".concat(null===y||void 0===y?void 0:y._id,".marketing.promotions.").concat(re))),ce=le[0],ue=le[1],de=(0,p.useRouter)(),me=(0,f.useSession)().data,pe=(0,M.Z)(),fe=pe.get,he=pe.post,xe=pe.remove,ve=(0,W.Z)(),ge=ve.confirm,be=ve.ConfirmDialog,je=(0,u.useRef)(null),ye=(0,u.useRef)(null),we="email"===re?"email":"google-ad"===re?"ad":"post",Ne=function(){var e=(0,o.Z)((function(){var e,t;return(0,l.__generator)(this,(function(n){switch(n.label){case 0:return E(!0),[4,fe("/website/get",{populate:!0})];case 1:return(e=n.sent())&&!0===e.status&&e.content&&(t=(0,s.Z)((0,i.Z)({},e.content),{subdomain:(0,h.nv)(e.content.subdomain,e.content.durableDomain)}),(0,h.Fs)("website",t),C(t)),E(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=(0,o.Z)((function(){var e,t;return(0,l.__generator)(this,(function(n){switch(n.label){case 0:return E(!0),[4,fe("/marketing/get-promotions",{page:T,perPage:15,query:O,type:re}).catch(console.log)];case 1:return(e=n.sent())&&!0===e.status&&e.content&&(t=1===T?e.content:(0,s.Z)((0,i.Z)({},e.content),{promotions:(0,a.Z)(ce.promotions).concat((0,a.Z)(e.content.promotions))}),(0,h.Fs)("marketing.promotions.".concat(re),t),ue(t)),E(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Ce=function(){var e=(0,o.Z)((function(e,t){var n;return(0,l.__generator)(this,(function(o){switch(o.label){case 0:return E(!0),delete e._id,[4,he("/marketing/create-promotion",e).catch(console.log)];case 1:return(n=o.sent())&&!0===n.status&&n.content?(h.Z9.success("".concat(t," duplicated!")),[4,de.push("/marketing/promotions/".concat(n.content._id))]):[3,3];case 2:return o.sent(),Ze(),[3,4];case 3:h.Z9.error("Error saving this item, please try again."),E(!1),o.label=4;case 4:return[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),Ze=function(){var e=(0,o.Z)((function(){var e;return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return[4,fe("/marketing/count-promotions")];case 1:return(e=t.sent())&&!0===e.status&&e.content?te(e.content||0):te(0),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Ae=function(){var e,t,n,o,i,s;return ee>=((null===me||void 0===me||null===(e=me.user)||void 0===e||null===(t=e.plan)||void 0===t||null===(n=t.limits)||void 0===n?void 0:n.promotions)>=0?null===me||void 0===me||null===(o=me.user)||void 0===o||null===(i=o.plan)||void 0===i||null===(s=i.limits)||void 0===s?void 0:s.promotions:Number.MAX_SAFE_INTEGER)?(0,c.jsxs)("button",{className:(0,h.AK)("primary flex-shrink-0",q?"!hidden md:!flex":""),onClick:function(){return ie(!0)},children:[(0,c.jsxs)("span",{className:"hidden lg:inline-block",children:["Create ",we]}),(0,c.jsx)("span",{className:"lg:hidden",children:"Create"})]}):(0,c.jsxs)("button",{className:(0,h.AK)("primary flex-shrink-0",q?"!hidden md:!flex":""),onClick:function(){return Q(!0)},disabled:A,children:[(0,c.jsxs)("span",{className:"hidden lg:inline-block",children:["Create ",we]}),(0,c.jsx)("span",{className:"lg:hidden",children:"Create"})]})};return(0,u.useEffect)((function(){var e,t,n;((null===de||void 0===de||null===(e=de.query)||void 0===e?void 0:e.create)&&Q(!0),"search"===(null===de||void 0===de||null===(t=de.query)||void 0===t?void 0:t.focus)&&(null===ce||void 0===ce?void 0:ce.exists)&&ee>=0)&&(null===(n=je.current)||void 0===n||n.focus(),$(!0),de.push(de.pathname,void 0,{shallow:!0}))}),[de,ce,ee]),(0,u.useEffect)((function(){return clearTimeout(ye.current),ye.current=setTimeout((function(){ke()}),O?400:10),function(){clearTimeout(ye.current)}}),[O,re,T]),(0,u.useEffect)((function(){Ne(),Ze()}),[]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(U.Z,{context:"promotions",open:oe,setOpen:ie}),!ce||ee<0?(0,c.jsx)(S,{isLoading:!0}):"",ce&&!ce.exists&&ee>=0&&(0,c.jsx)("div",{className:"flex items-center justify-center w-full h-full",children:(0,c.jsx)(G.Z,{imgSrc:(0,h.sd)("promotion/".concat(V[we].img)),type:we,title:V[we].title,subtitle:V[we].subtitle,cta:(0,c.jsx)(Ae,{})})}),ce&&ce.exists&&ee>=0&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"flex items-center justify-between gap-3 mb-4 lg:mb-6",children:[(0,c.jsxs)("div",{className:"flex items-center gap-3 w-full lg:w-auto",children:[(0,c.jsxs)("div",{className:(0,h.AK)("items-center gap-3",q?"flex mb-[1px] w-full":"hidden md:flex"),children:[(0,c.jsxs)("div",{className:"flex-1 relative",children:[(0,c.jsx)("span",{className:"absolute top-1/2 z-10 pl-2.5 -translate-y-1/2",children:(0,c.jsx)(m.Z,{icon:"SearchIcon",className:"w-5 h-5"})}),(0,c.jsx)("input",{className:"flex-1 md:w-auto md:min-w-80 input !pl-9",value:O,onChange:function(e){z(e.currentTarget.value),I(1)},placeholder:"Search",ref:je})]}),(0,c.jsx)("div",{className:"flex-shrink-0 md:hidden",children:(0,c.jsx)("button",{className:"round secondary",onClick:function(){return $(!1)},children:(0,c.jsx)(m.Z,{icon:"XIcon",className:"w-4 h-4 text-gray-700"})})})]}),(0,c.jsx)("div",{className:(0,h.AK)(q?"hidden":"md:hidden"),children:(0,c.jsx)("button",{className:"round light",onClick:function(){return $(!0)},children:(0,c.jsx)(m.Z,{icon:"SearchIcon",className:"w-5 h-5"})})}),j.length>1&&(0,c.jsx)(X.Z,{className:(0,h.AK)("md:min-w-80 w-full",q?"hidden md:block":""),placeholder:"All",values:j,value:re&&(null===j||void 0===j?void 0:j.find((function(e){return e.id===re}))),onChange:function(e){ae(e.id),I(1)}})]}),(0,c.jsx)(Ae,{})]}),(null===ce||void 0===ce||null===(t=ce.promotions)||void 0===t?void 0:t.length)>0?(0,c.jsx)(S,{promotions:ce.promotions,domain:(null===k||void 0===k?void 0:k.domain)||(0,h.lz)(k),author:{name:null===y||void 0===y?void 0:y.name,picture:null===y||void 0===y||null===(n=y.picture)||void 0===n?void 0:n.url},onDelete:function(e,t){ge("Delete ".concat(t,"?"),"Are you sure you want to delete this ".concat(t,"?"),(0,o.Z)((function(){var n;return(0,l.__generator)(this,(function(o){switch(o.label){case 0:return E(!0),[4,xe("/marketing/delete-promotion",{idPromotion:e._id}).catch(console.log)];case 1:return(n=o.sent())&&!0===n.status?(h.Z9.success("".concat(t," deleted!")),ke(),Ze()):(h.Z9.error(n.error),E(!1)),[2]}}))})))},onDuplicate:Ce}):(0,c.jsx)("div",{className:"py-6 px-4 bg-white",children:(0,c.jsx)("div",{className:"p-4 bg-gray-50 rounded-lg text-sm text-gray-500",children:"No promotion found"})}),(null===ce||void 0===ce?void 0:ce.total)>15*T&&(0,c.jsx)(B.Z,{className:"primary !flex mx-auto",onClick:function(){return I(T+1)},loading:A,children:"Load more"})]}),j.length>1&&J&&(0,c.jsx)(P,{open:J,setOpen:Q,onSelect:function(e,t){return de.push("/marketing/promotions/create?type=".concat(e,"&topic=").concat(t))},vertical:(0,K.x)(null===k||void 0===k?void 0:k.Business),businessName:null===k||void 0===k||null===(x=k.Business)||void 0===x?void 0:x.name,initialType:null===de||void 0===de||null===(v=de.query)||void 0===v?void 0:v.create}),j.some((function(e){return"google-ad"===e.id}))&&J&&(0,c.jsx)(L,{open:J,setOpen:Q,type:"ad",placeholder:"The studio's unique artistic vision, highlighting our ability to capture ethereal, dreamlike qualities in our photography.",onSelect:function(e){return de.push("/marketing/promotions/create?type=google-ad&topic=".concat(e))},vertical:(0,K.x)(null===k||void 0===k?void 0:k.Business),businessName:null===k||void 0===k||null===(g=k.Business)||void 0===g?void 0:g.name}),j.some((function(e){return"email"===e.id}))&&J&&(0,c.jsx)(L,{open:J,setOpen:Q,type:"email",placeholder:"A promotion for a free one-hour photo session.",onSelect:function(e){return de.push("/marketing/promotions/create?type=email&topic=".concat(e))},vertical:(0,K.x)(null===k||void 0===k?void 0:k.Business),businessName:null===k||void 0===k||null===(b=k.Business)||void 0===b?void 0:b.name}),(0,c.jsx)(be,{attention:!0})]})}}}]);