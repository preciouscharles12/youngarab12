"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9231],{33602:function(t,e,n){n.d(e,{q:function(){return r}});var r=(0,n(67294).createContext)((function(){}))},93281:function(t,e,n){n.d(e,{c:function(){return s}});var r=n(47568),o=n(51438),a=n(52951),i=n(97582),c=n(3732),s=function(){function t(e){var n=e.get,r=e.post,a=e.remove,i=e.put;(0,o.Z)(this,t),this.get=n,this.post=r,this.put=i,this.delete=a}return(0,a.Z)(t,[{key:"getContact",value:function(t){var e=this;return(0,r.Z)((function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.get("/customer/get",{idCustomer:t})];case 1:if(!0===(null===(n=r.sent())||void 0===n?void 0:n.status)&&(null===n||void 0===n?void 0:n.content))return[2,n.content];throw new Error("Failed to get contact: ".concat(null===n||void 0===n?void 0:n.message))}}))}))()}},{key:"getEvents",value:function(t,e){var n=this;return(0,r.Z)((function(){var r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return[4,n.get("/scheduler/get-events",{customerId:t,startDate:e})];case 1:if(!0===(null===(r=o.sent())||void 0===r?void 0:r.status)&&(null===r||void 0===r?void 0:r.content))return[2,r.content];throw new Error("Failed to get events: ".concat(null===r||void 0===r?void 0:r.message))}}))}))()}},{key:"getCustomFields",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"customer",e=this;return(0,r.Z)((function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.get("/custom-field/get-by-category",{category:t})];case 1:if(!0===(null===(n=r.sent())||void 0===n?void 0:n.status)&&(null===n||void 0===n?void 0:n.content))return(0,c.Fs)("customer.custom-fields",n.content),[2,n.content];throw new Error("Failed to get custom fields: ".concat(null===n||void 0===n?void 0:n.message))}}))}))()}},{key:"getContactInvoices",value:function(t){var e=t.idCustomer,n=t.page,o=void 0===n?1:n,a=t.perPage,c=void 0===a?10:a,s=t.sortby,u=void 0===s?"createdAt":s,l=t.order,d=void 0===l?1:l,v=t.statuses,f=void 0===v?[]:v,m=this;return(0,r.Z)((function(){var t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,m.get("/invoice/get-by-filter",{page:o,perPage:c,idCustomer:e,sortby:u,order:d,statuses:f})];case 1:if(!0===(null===(t=n.sent())||void 0===t?void 0:t.status)&&(null===t||void 0===t?void 0:t.content))return[2,t.content];throw new Error("Failed to get invoices for customer: ".concat(null===t||void 0===t?void 0:t.message))}}))}))()}},{key:"updateContact",value:function(t){var e=this;return(0,r.Z)((function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.post("/customer/edit",t)];case 1:if((n=r.sent())&&!0===n.status)return[2,n.content];throw new Error("Failed to update contact: ".concat(null===n||void 0===n?void 0:n.message))}}))}))()}},{key:"createContactNote",value:function(t,e){var n=this;return(0,r.Z)((function(){var r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return[4,n.post("/customer/".concat(t._id,"/notes"),{body:e})];case 1:if((r=o.sent())&&!0===r.status)return[2,r.content];throw new Error("Failed to create note: ".concat(null===r||void 0===r?void 0:r.message))}}))}))()}},{key:"updateContactNote",value:function(t,e){var n=e._id,o=e.body,a=this;return(0,r.Z)((function(){var e;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,a.put("/customer/".concat(t._id,"/notes/").concat(n),{body:o})];case 1:if((e=r.sent())&&!0===e.status)return[2,e.content];throw new Error("Failed to create note: ".concat(null===e||void 0===e?void 0:e.message))}}))}))()}},{key:"deleteContactNote",value:function(t,e){var n=this;return(0,r.Z)((function(){var r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return[4,n.delete("/customer/".concat(t,"/notes/").concat(e))];case 1:if((r=o.sent())&&!0===r.status)return[2,r.content];throw new Error("Failed to create note: ".concat(null===r||void 0===r?void 0:r.message))}}))}))()}},{key:"getContactEmails",value:function(t){var e=t.idCustomer,n=t.page,o=void 0===n?0:n,a=t.perPage,c=void 0===a?10:a,s=this;return(0,r.Z)((function(){var t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,s.get("/nylas/get-threads",{page:o,perPage:c,idCustomer:e})];case 1:if((t=n.sent())&&!0===t.status)return[2,t.content];throw new Error("Failed to get emails: ".concat(null===t||void 0===t?void 0:t.message))}}))}))()}},{key:"markContactFormMsgsRead",value:function(t,e){var n=this;return(0,r.Z)((function(){var r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return[4,n.post("/customer/read-message",{idCustomer:t,idx:e})];case 1:if((r=o.sent())&&!0===r.status)return[2,r.content];throw new Error("Failed to mark messages as read: ".concat(null===r||void 0===r?void 0:r.message))}}))}))()}},{key:"getUnreadEmailsCount",value:function(t){var e=t.customerIds,n=void 0===e?[]:e,o=this;return(0,r.Z)((function(){var t;return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return Array.isArray(n)&&0!==n.length?[4,o.get("/nylas/count-unread-threads",{idsCustomer:n})]:[2,Promise.resolve(0)];case 1:return(t=e.sent())&&!0===t.status?[2,t.content]:[2,[]]}}))}))()}},{key:"importCSV",value:function(t){var e=t.selectedFields,n=t.csvData,o=t.errors,a=this;return(0,r.Z)((function(){var t;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:if(e.email<0)throw new Error("You can't ignore the email field.");return[4,a.post("/customer/import-csv",{data:n,selectedFields:e,ignoreLines:o.map((function(t){return t.row}))})];case 1:if((t=r.sent())&&!0===t.status)return[2,t.content||{}];throw new Error("Failed to import contacts: ".concat(null===t||void 0===t?void 0:t.message))}}))}))()}}]),t}()},5137:function(t,e,n){n.d(e,{Z:function(){return a}});var r=n(67294),o=n(3732);function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";return(0,r.useEffect)((function(){t&&(o.Z9[e](t),"error"===e&&console.error(t))}),[t,e]),null}},44617:function(t,e,n){n.d(e,{B$:function(){return f},Ci:function(){return l},Fg:function(){return u},Ir:function(){return m},LE:function(){return i},No:function(){return c},ZK:function(){return s},bW:function(){return v},hW:function(){return d}});var r=n(30120),o=n(57460),a=n.n(o);function i(t){return[{name:"Overview",href:"/crm/".concat(t)},{name:"Messages",href:"/crm/".concat(t,"/messages")},{name:"Notes",href:"/crm/".concat(t,"/notes")},{name:"Invoices",href:"/crm/".concat(t,"/invoices")}]}function c(t){return"".concat((null===t||void 0===t?void 0:t.firstName)||""," ").concat((null===t||void 0===t?void 0:t.lastName)||"").trim()}function s(t){return Array.isArray(t)?t.sort((function(t,e){var n=t.createdAt?new Date(t.createdAt):new Date(0);return(e.createdAt?new Date(e.createdAt):new Date(0))-n})):[]}function u(t){var e,n,r,o;return!((null===t||void 0===t||null===(e=t.business)||void 0===e||null===(n=e.nylas)||void 0===n?void 0:n.invalid)||!(null===t||void 0===t||null===(r=t.business)||void 0===r||null===(o=r.nylas)||void 0===o?void 0:o.token))}function l(t){return t?r.ou.fromISO(t).toFormat("MMM dd, yyyy"):""}function d(t){return(null===t||void 0===t?void 0:t.firstName)||(null===t||void 0===t?void 0:t.lastName)?"By ".concat(t.firstName?t.firstName+" ":"").concat(t.lastName||""):""}function v(t){return new Promise((function(e,n){a().parse(t,{header:!0,skipEmptyLines:!0,complete:function(t){e({csvData:t.data,fields:t.meta.fields,errors:t.errors})},error:function(t){n(t)}})}))}function f(t){return t.size>10485760?'"'.concat(t.name,'" is greater than 10MB.'):!t.name.match(/.csv$/i)||"text/csv"!==t.type&&"application/vnd.ms-excel"!==t.type?'"'.concat(t.name,'" is not a csv file.'):void 0}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"reply";if(!t)return"";if(!t.from)return"<div>".concat(e,"</div>");var a=r.ou.fromSeconds(t.date).toFormat("ff");if("forward"===o)return'<div>\n      <br/>\n      <br/>\n      <br/>\n      <div class="gmail_quote">\n        <div dir="ltr" class="gmail_attr">\n          ---------- Forwarded message ---------\n          <br>\n          From: '.concat(t.from.map((function(t){return'<strong class="gmail_sendername" dir="auto">'.concat(t.name,'</strong> <span dir="auto">&lt;<a href="mailto:').concat(t.email,'" target="_blank">').concat(t.email,"</a>&gt;</span>")})),"\n          <br>\n          Date: ").concat(a,"\n          <br>\n          Subject: ").concat(t.subject,"\n          <br>\n          To: ").concat(t.to.map((function(t){return"".concat(t.name,' &lt;<a href="mailto:').concat(t.email,'" target="_blank">').concat(t.email,"</a>&gt;")})),"\n          ").concat(t.cc.length>0?"<br>Cc: ".concat(t.cc.map((function(t){return"".concat(t.name,' &lt;<a href="mailto:').concat(t.email,'" target="_blank">').concat(t.email,"</a>&gt;")}))):"","\n        </div>\n        <br/>\n        <br/>\n        <br/>\n        ").concat(t.body,"\n      </div>\n    </div>");var i=n;"string"===typeof n&&(i=t.body),"string"!==typeof i&&(i="");var c='\n      <br/>\n      <br/>\n      <br/>\n      <div class="gmail_quote">\n        <div dir="ltr" class="gmail_attr">\n            On '.concat(a," ").concat(t.from.map((function(t){return"".concat(t.name," &lt;").concat(t.email,"&gt;")})),' wrote:\n        </div>\n        <br/>\n        <blockquote class="gmail_quote" style="margin: 0 0 0 0.8ex; border-left: 1px solid rgb(204, 204, 204); padding-left: 1ex;">\n            ').concat(n||t.body,"\n        </blockquote>\n      </div>\n    ");return"<div><div>".concat(e,"</div>").concat(c,"</div>")}}}]);